(()=>{var i="site-static-v1.2",r=["/","/index.min.js","/beautifier.min.js"];self.addEventListener("install",n=>{n.waitUntil(caches.open(i).then(e=>e.addAll(r)).then(()=>self.skipWaiting()))});self.addEventListener("activate",n=>{n.waitUntil(caches.keys().then(e=>Promise.all(e.map(t=>t!==i?caches.delete(t):Promise.resolve()))).then(()=>self.clients.claim()))});self.addEventListener("fetch",n=>{let e=n.request;if(e.method==="GET"){if(e.mode==="navigate"){n.respondWith(o());return}n.respondWith(caches.match(e).then(t=>{let s=fetch(e).then(a=>(a&&a.status===200&&caches.open(i).then(c=>{try{c.put(e,a.clone())}catch{}}),a.clone,a)).catch(()=>e.destination==="image"?new Response("",{status:404,statusText:"offline"}):null);return t?Promise.resolve(t):s}))}});async function o(){let n=await caches.open(i),e=await n.match("/");try{let t=await fetch("/",{redirect:"follow"});return t.ok&&!t.redirected&&n.put("/",t.clone()),t}catch(t){return console.error("[SW] navigation fetch failed:",t),e||new Response("Offline",{status:503,headers:{"Content-Type":"text/plain"}})}}})();
